This “The authorization code has expired or already been used” error usually indicates one of two things in the OAuth 2.0 flow:
	1.	You’re trying to use the same authorization code more than once (e.g., a page reload or a second request is re-sending the same code), or
	2.	You waited longer than 10 minutes to exchange the code for an access token.

QuickBooks (like most OAuth 2 providers) only allows each authorization code to be exchanged once, and the code expires if not used within 10 minutes.

⸻

How to Fix It
	1.	Use the authorization code immediately
	•	As soon as QBO redirects back to your callback with the code, your code should exchange it for an access token exactly once. If you refresh the page or re-trigger the exchange, you’ll get the “already used” error.
	2.	Prevent double submissions
	•	If your callback logic runs on page load, make sure you don’t re-run it on a refresh or a second load.
	•	Sometimes frameworks or code can automatically retry or call the token endpoint multiple times. Make sure only one call is made.
	3.	Verify you’re storing tokens correctly
	•	Once you get an access token and refresh token, you shouldn’t keep reusing the authorization code. Your app should store the tokens (e.g., in a database or session) and use them for subsequent API calls.
	•	If you need to refresh your access token later, use the refresh token (not the authorization code again).
	4.	Keep an eye on the 10-minute window
	•	If you step away or debug for a while after getting the authorization code, that code will expire. Just re-initiate the “Connect to QuickBooks” flow to get a fresh code.

⸻

Typical Flow
	1.	User clicks “Connect to QuickBooks.”
	2.	User is redirected to Intuit to log in and grant permissions.
	3.	Intuit redirects back to your app’s callback with ?code=<authorization_code>.
	4.	Immediately exchange <authorization_code> for access/refresh tokens by calling Intuit’s token endpoint.
	5.	Store the tokens in your database or session.
	6.	Use the stored access token for QBO API calls; if it expires, use the refresh token to get a new access token (no need to ask the user to sign in again unless the refresh token also expires).

⸻

Next Steps
	•	Re-run the OAuth flow from the start so you get a fresh, valid code.
	•	Make sure you only attempt the token exchange once.
	•	Confirm you’re storing the resulting tokens and not reusing the authorization code on subsequent requests.

Following these steps should resolve the “The authorization code has expired or already been used” error and let you proceed with valid access tokens.